---
# yaml-language-server: $schema=../docs-resources/schemas/defs-schema.json

$schema: "../docs-resources/schemas/defs-schema.json#"

# Used to create normative rules for rv32.adoc file.
# Tags refer to anchors in any adoc file for any ISA manual.
chapter_name: Machine Mode

normative_rule_definitions:
  # M-mode general
  - name: M_highest_priv_mode
    tag: "norm:M_highest_priv_mode"
  - name: M_mode_at_reset
    tag: "norm:M_mode_at_reset"
  - name: M_access_all_lower_priv_CSRs
    tag: "norm:M_access_all_lower_priv_CSRs"

  # CSR misa
  - name: misa_acc
    tag: "norm:misa_acc"
  - name: misa_always_rd
    tag: "norm:misa_always_rd"
  - name: misa_csr_implemented
    tag: "norm:misa_csr_implemented"
    kind: parameter
    description: |
      Whether or not the `misa` CSR returns zero or a non-zero value.

      Possible values:
        * true - The `misa` CSR returns a non-zero value.
        * false - The `misa` CSR is read-only-0.
  - name: misa_enc_img
    tag: "norm:misa_enc_img"
  - name: misa_mxl_op
    tags:
      - "norm:misa_mxl_op_isa"
      - "norm:misa_mxl_op_nz"
  - name: mxlen
    tags:
      - "norm:misa_mxl_op_nz"
      - "norm:xlen_le_mxlen"
    kind: parameter
    description: XLEN in M-mode
  - name: misa_mxl_acc
    tag: "norm:misa_mxl_acc"
  - name: misa_mxl_enc
    tag: "norm:misa_mxl_enc"
  - name: misa_sz
    tag: "norm:misa_sz"
  - name: misa_extensions_enc
    tags: ["norm:misa_extensions_enc_txt", "norm:misa_extensions_enc_tbl"]
  - name: misa_extensions_op
    tag: "norm:misa_extensions_op"
  - name: misa_extensions_rst
    tag: "norm:misa_extensions_rst"
  - name: misa_extensions_disabling
    description: what happens when you turn off bits
    tag: "norm:misa_extensions_disabling"
  - name: misa_extensions_impl_def
    tag: "norm:misa_extensions_impl_def"
  - name: misa_extensions_disabling_def
    tag: "norm:misa_extensions_disabling_def"
  - name: misa_extensions_rsv_ret_0
    tag: "norm:misa_extensions_rsv_ret_0"
  - name: misa_i_op
    tag: "norm:misa_i_op"
  - name: misa_e_op
    tag: "norm:misa_e_op"
  - name: misa_x_op
    tag: "norm:misa_x_op"
  - name: misa_b_op
    tag: "norm:misa_b_op"
  - name: misa_m_op
    tag: "norm:misa_m_op"
  - name: misa_s_op
    tag: "norm:misa_s_op"
  - name: misa_u_op
    tag: "norm:misa_u_op"
  - name: misa_e_not_i
    tag: "norm:misa_e_not_i"
  - name: Zmmul_misa_m
    tag: "norm:Zmmul_misa_m"
  - name: misa_e_acc
    tag: "norm:misa_e_acc"
  - name: misa_extensions_dependencies
    tag: "norm:misa_extensions_dependencies"
  - name: misa_inc_ialign
    tag: "norm:misa_inc_ialign"

  # CSR mvendorid
  - names: [mvendorid_sz, mvendorid_acc, mvendorid_op]
    tag: "norm:mvendorid_sz_acc_op"
  - name: vendor_id_bank
    tag: "norm:mvendorid_sz_acc_op"
    kind: parameter
    description: JEDEC Vendor ID bank, for CSR mvendorid
  - name: vendor_id_offset
    tag: "norm:mvendorid_sz_acc_op"
    kind: parameter
    description: JEDEC Vendor ID offset, for CSR mvendorid
  - name: mvendorid_always_rd
    tag: "norm:mvendorid_always_rd"
  - name: mvendorid_enc
    tag: "norm:mvendorid_enc"

  # CSR marchid
  - names: [marchid_sz, marchid_acc, marchid_op]
    tag: "norm:marchid_sz_acc_op"
  - name: arch_id
    tag: "norm:marchid_sz_acc_op"
    kind: parameter
    description: Vendor-specific architecture ID for CSR marchid
  - name: marchid_always_rd
    tag: "norm:marchid_always_rd"

  # CSR mimpid
  - name: mimpid_op
    tag: "norm:mimpid_op"
  - name: imp_id
    tag: "norm:mimpid_op"
    kind: parameter
    description: Vendor-specific implementation ID for CSR mimpid
  - name: mimpid_always_rd
    tag: "norm:mimpid_always_rd"

  # CSR mhartid
  - names: [mhartid_sz, mhartid_acc, mhartid_op]
    tag: "norm:mhartid_sz_acc_op"
  - name: hart_id
    tag: "norm:mhartid_sz_acc_op"
    kind: parameter
    description: Instance-specific ID for CSR mhartid
  - name: mhartid_always_rd
    tag: "norm:mhartid_always_rd"
  - name: mhartid_one_is_zero
    tag: "norm:mhartid_one_is_zero"
  - name: mhartid_unique
    tag: "norm:mhartid_unique"

  # CSR mstatus
  - names: [mstatus_sz, mstatus_acc]
    tag: "norm:mstatus_sz_acc"
  - names: [mstatush_sz, mstatush_acc]
    tag: "norm:mstatush_sz_acc"
  - name: mstatush_enc
    tag: "norm:mstatush_enc"
  - names: [mstatus_mie_op, mstatus_sie_op]
    tags: ["norm:mstatus_mie_sie_op1", "norm:mstatus_mie_sie_op2"]
  - name: mstatus_mie_clr_by_mdt
    tag: "norm:mstatus_mie_clr_by_mdt"
  - name: mstatus_mie_clr_by_mdt_rv64
    tags: ["norm:mstatus_mie_clr_by_mdt", "norm:mstatus_mie_clr_by_mdt_rv64"]
  - name: mstatus_mie_set_mdt_0
    tag: "norm:mstatus_mie_set_mdt_0"
  - name: mstatus_mie_set_mdt_0_rv64
    tags: ["norm:mstatus_mie_set_mdt_0", "norm:mstatus_mie_set_mdt_0_rv64"]
  - name: mstatus_xie_intr_en_dis
    tag: "norm:mstatus_xie_intr_en_dis"
  - names: [mstatus_sie_rdonly0, mstatus_spie_rdonly0]
    tag: "norm:mstatus_sie_spie_rdonly0"
  - names: [mstatus_xpie_op, mstatus_xpp_op]
    tags: ["norm:mstatus_xpie_xpp_op"]
  - names: [mstatus_xpie_trap_op, mstatus_xie_trap_op, mstatus_xpp_trap_op]
    tag: "norm:mstatus_xpie_xie_xpp_trap_op"
  - names: [mstatus_xie_xret_op, mstatus_xpie_xret_op, mstatus_xpp_xret_op, mstatus_mprv_xret_op]
    tag: "norm:mstatus_xret_op"
  - name: mstatus_xpp_enc
    tag: "norm:mstatus_xpp_enc"
  - name: mstatus_mpp_sz
    tag: "norm:mstatus_mpp_sz"
  - name: mstatus_xpp_warl
    tag: "norm:mstatus_xpp_warl"
  - name: mstatus_xpp_rdonly0
    tag: "norm:mstatus_xpp_rdonly0"
  - name: mstatus_spp_sz
    tag: "norm:mstatus_spp_sz"
  - names: [mstatus_mdt_sz, mstatus_mdt_warl]
    tag: "norm:mstatus_mdt_sz_warl"
  - name: mstatus_mdt_rst
    tag: "norm:mstatus_mdt_rst"
  - name: mstatus_mdt_not_set_rnmi
    tag: "norm:mstatus_mdt_not_set_rnmi"
  - name: mstatus_mdt_clr_mret_sret
    tag: "norm:mstatus_mdt_clr_mret_sret"
  - name: mstatus_mdt_clr_mnret
    tag: "norm:mstatus_mdt_clr_mnret"
  - names:
      - mstatus_sxl_warl
      - mstatus_uxl_warl
      - mstatus_sxl_op
      - mstatus_uxl_op
    tag: "norm:mstatus_sxl_uxl_warl_op"
  - names: [mstatus_sxl_enc, mstatus_uxl_enc]
    tags: ["norm:mstatus_sxl_uxl_warl_op", "norm:mstatus_sxl_uxl_enc"]
  - names: [mstatus_sxl_exist_mxlen32, mstatus_uxl_exist_mxlen32]
    tag: "norm:mstatus_sxl_uxl_sxlen_uxlen_mxlen32"
  - name: mstatus_sxl_acc_mxlen64
    tag: "norm:mstatus_sxl_acc_mxlen64"
  - name: mstatus_sxl_rdonly_mxlen64
    tag: "norm:mstatus_sxl_rdonly_mxlen64"
    kind: parameter
  - name: mstatus_uxl_acc_mxlen64
    tag: "norm:mstatus_uxl_acc_mxlen64"
  - name: mstatus_uxl_rdonly_mxlen64
    tag: "norm:mstatus_uxl_rdonly_mxlen64"
  - name: mstatus_uxl_legal_vals_smode
    tag: "norm:mstatus_uxl_legal_vals_smode"
    kind: parameter
  - name: mstatus_mprv_ldst_op
    tag: "norm:mstatus_mprv_ldst_op"
  - name: mstatus_mprv_inst_xlat_op
    tag: "norm:mstatus_mprv_inst_xlat_op"
  - name: mstatus_mprv_rdonly0_no_umode
    tag: "norm:mstatus_mprv_rdonly0_no_umode"
  - name: mstatus_mprv_clr_mret_sret_less_priv
    tag: "norm:mstatus_mprv_clr_mret_sret_less_priv"
  - name: mstatus_mxr_op
    tag: "norm:mstatus_mxr_op"
  - name: mstatus_mxr_rdonly0_no_smode
    tag: "norm:mstatus_mxr_rdonly0_no_smode"
  - name: mstatus_sum_op
    tag: "norm:mstatus_sum_op"
  - name: mstatus_sum_op_no-vm
    tag: "norm:mstatus_sum_op_no-vm"
  - name: mstatus_sum_op_mprv_mpp
    tag: "norm:mstatus_sum_op_mprv_mpp"
  - name: mstatus_sum_rdonly0
    tag: "norm:mstatus_sum_rdonly0"
  - name: mstatus_mxr_sum_op_acc_fault
    tag: "norm:mstatus_mxr_sum_op_acc_fault"
  - names:
      - mstatus_mbe_warl
      - mstatus_sbe_warl
      - mstatus_ube_warl
      - mstatush_mbe_warl
      - mstatush_sbe_warl
      - mstatush_ube_warl
    tag: "norm:mstatus_mstatush_xbe_warl"
  - name: mstatus_mbe_op
    tag: "norm:mstatus_mbe_op"
  - name: mstatus_sbe_op
    tag: "norm:mstatus_sbe_op"
  - name: mstatus_sbe_implicit
    tag: "norm:mstatus_sbe_implicit"
  - name: mstatus_sbe_change_fence
    tags: ["norm:mstatus_sbe_implicit", "norm:mstatus_sbe_change_fence"]
  - name: mstatus_sbe_rocopy
    tag: "norm:mstatus_sbe_rocopy"
    kind: parameter
  - name: mstatus_ube_op
    tag: "norm:mstatus_ube_op"
  - name: mstatus_ube_rocopy
    tag: "norm:mstatus_ube_rocopy"
    kind: parameter
  - name: mstatus_tvm_warl
    tag: "norm:mstatus_tvm_warl_op"
  - name: mstatus_tvm_op
    tag: "norm:mstatus_tvm_warl_op"
  - name: mstatus_tw_warl
    tag: "norm:mstatus_tw_warl"
  - name: mstatus_tw_op
    tag: "norm:mstatus_tw_op"
    clarification-link: https://github.com/riscv/riscv-isa-manual/issues/2462
    clarification-text: |
      "Lower privilege modes" and "less-privileged mode" are relative to M-mode.
  - name: mstatus_tw_umode_op
    tag: "norm:mstatus_tw_umode_op"
    clarification-link: https://github.com/riscv/riscv-isa-manual/issues/2463
    clarification-text: "Behavior is true independent of the value of mstatus.tw"
  - name: mstatus_tw_acc
    tag: "norm:mstatus_tw_acc"
  - name: mstatus_tw_time_limit
    tag: "norm:mstatus_tw_op"
    kind: parameter
  - name: mstatus_tw_always_illegal
    tag: "norm:mstatus_tw_always_illegal"
    kind: parameter
  - name: mstatus_tsr_warl
    tag: "norm:mstatus_tsr_warl"
  - name: mstatus_tsr_op
    tag: "norm:mstatus_tsr_op"
  - name: mstatus_tsr_acc
    tag: "norm:mstatus_tsr_acc"
  - names:
      - mstatus_fs_warl
      - mstatus_vs_warl
    tag: "norm:mstatus_fs_vs_warl"
  - names:
      - mstatus_fs_enc
      - mstatus_vs_enc
      - mstatus_xs_enc
    tag: "norm:mstatus_fs_vs_xs_enc"
  - name: mstatus_fs_acc
    tags: ["norm:mstatus_fs_acc1", "norm:mstatus_fs_acc2"]
  - name: mstatus_fs_rdonly0_s-no-f
    tag: "norm:mstatus_fs_rdonly0_s-no-f"
    kind: parameter
  - name: mstatus_vs_acc
    tags: ["norm:mstatus_vs_acc1", "norm:mstatus_vs_acc2"]
  - name: mstatus_vs_rdonly0_s-no-v
    tag: "norm:mstatus_vs_rdonly0_s-no-v"
    kind: parameter
  - name: mstatus_xs_acc
    tag: "norm:mstatus_xs_acc"
  - name: mstatus_fs_op
    tag: "norm:mstatus_fs_op"
  - name: mstatus_vs_op
    tag: "norm:mstatus_vs_op"
  - name: mstatus_xs_op
    tag: "norm:mstatus_xs_op"

  # CSR sstatus
  - name: sstatus_sdt_clr_mret_sret
    tags: ["norm:mstatus_mdt_clr_mret_sret", "norm:sstatus_sdt_clr_mret_sret"]
  - name: sstatus_sdt_clr_mnret
    tags: ["norm:mstatus_mdt_clr_mnret", "norm:sstatus_sdt_clr_mnret"]

  # CSR vsstatus
  - name: vsstatus_sdt_clr_mret_sret
    tags: ["norm:mstatus_mdt_clr_mret_sret", "norm:vsstatus_sdt_clr_mret_sret"]
  - name: vsstatus_sdt_clr_mnret
    tags: ["norm:mstatus_mdt_clr_mnret", "norm:vsstatus_sdt_clr_mnret"]

  # Misc
  - names: [SXLEN, UXLEN]
    tags: ["norm:sxlen_uxlen", "norm:mstatus_sxl_uxl_sxlen_uxlen_mxlen32"]
    kind: parameter
  - name: xlen_reduction_op
    tag: "norm:xlen_reduction_op"
  - name: xlen_reduction_hint_op
    tags: ["norm:xlen_reduction_hint_op1", "norm:xlen_reduction_hint_op2"]
    kind: parameter
  - name: endianness_inst_fetch_little
    tag: "norm:endianness_inst_fetch_little"

  # Traps
  - name: trap_exp
    tag: "norm:trap_exp"
  - name: trap_unexp
    tags: ["norm:trap_exp", "norm:trap_unexp_mdt_1"]
  - name: trap_unexp_rnmi
    tag: "norm:trap_unexp_rnmi"
  - name: trap_unexp_mnstatus_nmie_0
    tag: "norm:trap_unexp_mnstatus_nmie_0"
  - name: trap_unexp_hndl_rnmi
    tags:
      - "norm:trap_unexp_hndl_lead-in"
      - "norm:trap_unexp_hndl_rnmi"
  - name: trap_unexp_hndl_no_rnmi
    tags:
      - "norm:trap_unexp_hndl_lead-in"
      - "norm:trap_unexp_hndl_no_rnmi"
  - name: critical-error
    tag: "norm:critical-error"
    kind: parameter
