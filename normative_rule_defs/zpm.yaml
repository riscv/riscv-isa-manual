---
# yaml-language-server: $schema=../docs-resources/schemas/defs-schema.json

$schema: ../docs-resources/schemas/defs-schema.json#

# Used to create normative rules for zpm.adoc file.
# Tags refer to anchors in any adoc file for any ISA manual.

chapter_name: Pointer Masking Extensions

normative_rule_definitions:
  -names: pa_validity
  -summary: XLEN-1 to physical address bits supported by the processor  must be zero
  -tags: ["norm:pa_validity"]

  -names: pa_ignore_transformation
  -summary: Ignore transformation replaces the upper PMLEN bits of PA with 0.
  -tags: ["norm:pa_ignore_transformation"]

  -names: pm_explicit_mem_acc
  -summary: When PM is enabled, ignore transformation is applied to explicit memory access.
  -tags: ["norm:pm_explicit_mem_acc"]

  -names: pm_implicit_mem_acc
  -summary: When PM is enabled, ignore transformation is not applied to implicit memory access.
  -tags: ["norm:pm_implicit_mem_acc"]

  -names: pm_priv_mode_only
  -summary: Pointer masking behavior depends only on the current privilege mode, never on the address.
  -tags: ["norm:pm_priv_mode_only"]

  -names: pm_exceptions
  -summary: Pointer masking must not be applied to SFENCE/HFENCE/SINVAL/HINVAL operations.
  -tags: ["norm:pm_exceptions"]

  -names: pm_effective_mode_mx
  -summary: Pointer masking follows the effective privilege mode; if MXR=1 at that mode, masking must not be applied.
  -tags: ["norm:pm_effective_mode_mx"]

  -names: pm_cmo_implementation
  -summary: Cache management operations must take into account pointer masking.
  -tags: ["norm:pm_cmo_implementation"]

  -names: pm_cpu_addr_only
  -summary: Pointer masking applies only to CPU-generated accesses, not MMU, IOMMU, or device accesses.
  -tags: ["norm:pm_cpu_addr_only"]

  -names: pm_to_misaligned_mem_acc
  -summary: Misaligned memory accesses must behave exactly as if pointer masking were applied to each aligned sub-access individually.
  -tags: ["norm:pm_to_misaligned_mem_acc"]

  -names: csr_software_writes
  -summary: CSR accesses are not pointer-masked; masking applies later only to explicit memory accesses and WARL width is unchanged.
  -tags: ["norm:csr_software_writes"]

  -names: csr_hardware_writes
  -summary: Pointer masking is applied for hardware writes to a CSR.
  -tags: ["norm:csr_hardware_writes"]

  -names: pm_rv64_only
  -summary: Pointer masking only applies to RV64.
  -tags: ["norm:pm_rv64_only"]

  -names: pm_rv32
  -summary: In RV32, trying to enable pointer masking will result in an illegal WARL write and not update the pointer masking configuration bits.
  -tags: ["norm:pm_rv32"]

  -names: pm_clear_on_xl
  -summary: Setting UXL/SXL/MXL to 1 will clear the corresponding pointer masking configuration bits.
  -tags: ["norm:pm_clear_on_xl"]

  -names: pmm_reset
  -summary: Setting UXL/SXL/MXL to 1 and back to 0 does not preserve the previous values of the PMM bits.
  -tags: ["norm:pmm_reset"]

  -names: hlvx_no_pm
  -summary: The memory accesses performed by the HLVX instructions are not subject to pointer masking.
  -tags: ["norm:hlvx_no_pm"]

  -names: pm_type
  -summary: The type of PA determines which type of pointer masking will be appiled.
  -tags: ["norm:pm_type"]

  -names: pm_no_sfence_required
  -summary: Pointer masking does not effect any memory management data structure.
  -tags: ["norm:pm_no_sfence_required"]
